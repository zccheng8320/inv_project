@{
    ViewBag.Title = "Sales";
}
<style>
    .select2-selection__rendered {
        line-height: 50px !important;
    }

    .select2-container .select2-selection--single {
        height: 50px !important;
    }

    .select2-selection__arrow {
        height: 50px !important;
    }

    .dropdownCssClass {
        font-size: 20px;
        text-align:left;
        color: black;
    }
    .containerCssClass {
        font-size: 30px;
        text-align:center;
        color: black;
    }
</style>
<main role="main" class="inner cover">
    <div class="container-fluid h1 text-left bg-dark" style="border:3px #808080 solid;padding:5px;">
        <div class="row">
            <div class="col-lg-4">單據號碼: </div>
            <div class="col-lg-4">出貨日期: </div>
            <div class="col-lg-4">收款月份: </div>
            <div class="w-100"></div>
            <div class="col-lg-4">客戶號碼: <select id="itemCode" style="width:400px;"></select></div>
            <div class="col-lg-4">聯 絡 人: </div>
            <div class="col-lg-4">電&emsp;&emsp;話: </div>
            <div class="w-100"></div>
            <div class="col-lg-8">客戶名稱: </div>
            <div class="col-lg-4">統一編號: </div>
            <div class="w-100"></div>
            <div class="col-lg-4">業務編號: </div>
            <div class="col-lg-4">姓&emsp;&emsp;名: </div>
            <div class="col-lg-4">發票號碼: </div>
            <div class="w-100"></div>
            <div class="col-lg-4">稅&emsp;&emsp;率: </div>
            <div class="col-lg-4">&emsp;&emsp;帳別: </div>
            <div class="col-lg-4">會計傳票: </div>
            <div class="w-100"></div>
            <div class="col-lg-12">付款方式: </div>
            <div class="w-100"></div>
            <div class="col-lg-12">備&emsp;&emsp;註: </div>
            <div class="w-100"></div>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <table id="table"
                       data-toggle="table"
                       data-height="460"
                       class="table table-dark table-bordered">
                    <thead class="bg-primary">
                        <tr>
                            <th>
                                產品號碼
                            </th>
                            <th>
                                品名規格
                            </th>
                            <th>
                                單價
                            </th>
                            <th>
                                註
                            </th>
                            <th>
                                數量
                            </th>
                            <th>
                                金額
                            </th>
                            <th>
                                備註
                            </th>
                        </tr>
                    </thead>
                </table>
            </div>
        </div>

    </div>
    <div class="container-fluid h3 text-left bg-dark" style="border:3px #808080 solid;padding:5px;">
        <div class="row">
            <div class="col-lg-4">銷貨合計: </div>
            <div class="col-lg-4">稅&emsp;&emsp;額: </div>
            <div class="col-lg-4">銷貨總額: </div>
        </div>
    </div>
    <div class="container-fluid h3 text-right bg-dark" style="border:3px #808080 solid;padding:5px;">
        <div class="row right">
            <div class="col-1">1> 查詢 </div>
            <div class="col-1">2> 新增 </div>
            <div class="col-1">3> 更改 </div>
            <div class="col-1">4> 刪除 </div>
            <div class="col-2">5> 印出貨單</div>
            <div class="col-2">7> 印出貨標籤</div>
            <div class="col-2">8> 多項查詢 </div>
        </div>
        <div class="row">
            <div class="col-1">+> 下筆 </div>
            <div class="col-1">-> 上筆 </div>
            <div class="col-1">/> 瀏頁 </div>
            <div class="col-1">P> 成交價 </div>
            <div class="col-2">Z> 異常核對 </div>
        </div>
    </div>
</main>
    <script>
        $(document).ready(function () {
            $("#itemCode").select2({
                dropdownCssClass: "dropdownCssClass",
                containerCssClass: "containerCssClass",
                maximumInputLength: 10,
                ajax: {
                    url: "/api/Customer",
                    dataType: 'json',
                    delay: 250,
                    type: 'post',
                    data: function (params) {
                        return {
                            CUST_CODE: params.term, // search term
                            page: params.page
                        };
                    },
                    processResults: function (data, params) {
                        var select2data = $.map(data, function(obj) {
                            obj.id = obj.id || obj.CUST_CODE;
                            obj.text = obj.text || obj.CUST_NAME;
                            return obj;
                          });
                        params.page = params.page | 1;
                        return {
                            results: select2data,
                            pagination: {
                                more: (params.page * 30) < data.total_count
                            }
                        }

                    },                    
                cache: true
                },                
                escapeMarkup: function (markup) {
                    return markup;
                },
                templateResult: formatRepo,
                templateSelection: formatRepoSelection,
                 "language": {
                   "noResults": function(){
                       return "查無結果";
                   }
               }
            });
            $('#itemCode').on('select2:select', function (e) {
                var data = e.params.data;
                
            });
            function formatRepo(repo) {
                if (repo.loading) return "搜尋中...";
                repo.id = repo.CUST_CODE;
                repo.text = repo.CUST_NAME;
                var markup = '<div class="container-fluid">' +
                    '<div class="row">' +
                    '<div class="col">' + repo.CUST_CODE + '</div>' +
                    '<div class="col">' + repo.CUST_NAME + '</div>' +
                    '</div>';
                markup += '</div>';
                return markup;
            }
            function formatRepoSelection(repo) {

                return repo.id;
            }
        });
    </script>
